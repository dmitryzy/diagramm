function [res]=Dat(Subst)
//
// Authors Цымай Д.В.
  //Исходные данные
  //Матрицы с исходными данными для расчета изобарно-изотермического потенциала вещества.
  //Каждая строка матрицы соответствует определенному температурному интервалу.
  //Образец матрицы:
  //res=[T1,T2,DH298,Da,Db,Dc,Dd,I1,I2;...]
  //T1,T2 -границы температурного интервала.
  //DH298,Da,Db,Dc,Dd,I1,I2 -коэффициенты уравнения для данного интервала
  //Исходные данные взяты из справочника 
  //Верятин У.Д. и др. -Термодинамические свойства неорганических веществ. Справочник (1965), с. 220
  //Таблица 3.3.1 Термодинамические потенциалы реакций образования окислов и гидроокисей.
  //
  select Subst
    //A
    case 'Ag2O'
      res=[298,500,30.589,-4.44,11.85,0,0.913,39.52,0.896];
    case 'Ag2O2'
      res=[298,500,23.0,-8.4,32.7,0,6.3,155.0,2.307];
    case 'Al2O3'
      res=[298,931.7,1675.6,16.08,-8.04,0,-18.8,429.02,-11.321;931.7,2300,0,-1.3,16.751,0,-18.648,340.01,-27.516;2300,2500,0,27.6,-1.62,0,11.79,503.3,64.921];
    case 'As2O3'
      res=[298,503,653,-60.3,182.1,0,11.7,-84.6,13.172;503,586,0,-60.3,182.1,0,11.7,-118.9,30.338;586,730,0,68.2,-21.4,0,11.7,675.7,8.549;730,883,0,-5.0,-21.4,0,11.7,78.7,91.967;883,2500,0,1.26,-4.6,0,11.7,221.1,-14.838];
    case 'AsO2'
      res=[298,883,367.6,-20.5,28.5,0,8.0,51.1,7.122;883,1200,0,-17.2,36.8,0,8.0,122.2,-31.443;1200,2000,0,35.2,-2.5,0,8.0,466.8,-28.227];
    case 'As2O5'
      res=[298,883,91.48,0.4,46.5,0,-2.9,495.3,-4.199;883,1200,0,2.9,62.8,0,-2.9,633,-81.329];     
    //B
    case 'BiO'
      res=[298,544.2,209,0.8,1.3,0,3.8,100.5,0.936;544.2,1175,0,-8.4,12.1,0,3.8,58.2,-6.732;1175,1900,0,9.6,-0.4,0,3.8,175.4,-3.722;1900,1920,0,20.5,-0.4,0,3.8,360.5,-196.74;1920,2500,0,-0.8,-0.4,0,3.8,59.9,70.34];
    case 'Bi2O3'
      res=[298,544.2,578,0.42,22.86,0,11.81,273.4,2.181;544.2,1090,0,-18.17,44.8,0,11.81,189.2,-12.95;1090,1833,0,33.9,-1.63,0,11.81,528.8,-13.724;1823,2163,0,55.1,-1.63,0,11.81,904.8,-398.29];
    case 'B2O3'
      res=[298,723,1264.4,-28.3,67.8,0,6.32,92.4,6.904;723,2313,0,62.89,-38.5,0,11.7,671.52,-8.382;2313,2500,0,25.5,-1.7,0,11.7,444.0,-52.38];
    case 'Ba2O'
      res=[298,648,615,20.1,-3.8,0,3.8,265,-4.664;648,880,0,20.1,-3.8,0,3.8,269.6,-5.836;880,977,0,28.5,-13.0,0,3.8,301.9,12.133;977,1040,0,13.0,-0.4,0,3.8,207.7,5.949;1040,1911,0,-16.3,-0.4,0,3.8,-105.5,120.16;1911,2500,0,3.8,-0.4,0,3.8,224.8,-218.89];      
    case 'BaO'
      res=[298,648,558.5,12.81,-2.47,0,-4.379,186.3,-5.38;648,977,0,12.81,-2.47,0,-4.379,187.1,-5.966;977,1911,0,5.0,3.8,0,-4.2,140.7,-9.06;1911,2196,0,15.1,3.8,0,-4.2,305.2,178.61;2196,2500,0,20.1,-0.4,0,3.8,311.5,-120.58];
    case 'BaO2'
      res=[298,648,630.1,-0.8,0.8,0,8.0,184.2,2.499;648,723,0,-0.8,0.8,0,8.0,185.1,1.863;723,977,0,30.1,-7.5,0,8.0,381,5.644;977,1911,0,22.2,-1.3,0,8.0,334.1,2.55];
    case 'BeO'
      res=[298,1556,599.1,-2.18,9.67,0,-4.35,90.43,-1.457;1556,2500,0,-2.9,14.65,0,-9.2,97.72,-16.375];
    //C
    case 'CuO'
      res=[298,1356.2,155.3,-1.17,9.09,0,3.8,86.2,0.867;1356.2,1609,0,-10.0,19.7,0,3.8,32.7,-6.067;1609,2200,0,12.1,-0.4,0,3.8,160.8,21.977];    
    case 'Cu2O'
      res=[298,1356.2,166.8,-2.6,13.0,0,3.8,59.9,1.31;1356.2,1503,0,-20.1,25.5,0,3.8,-47.7,-12.556;1503,2500,0,12.1,-0.4,0,3.8,142.4,24.664];
    case 'CdO'
      res=[298,594.1,260.4,0.84,-4.14,0,3.8,101.7,1.034;594.1,1040,0,-6.62,8.4,0,3.8,70.5,-2.797;1040,1832,0,2.3,8.4,0,3.8,230.7,-111.87];            
    case 'CaO'
      res=[298,723,635.1,2.6,5.07,0,-0.4,123.9,-1.415;723,1123,0,-1.76,13.86,0,-0.4,98.0,-1.407;1123,1755,0,-6.3,19.7,0,-0.4,75.8,-9.219;1755,2500,0,3.8,19.7,0,-0.4,254.1,-188.7];
    case 'CaO2'
      res=[298,723,654.8,-3.8,5.9,0,7.9,145.3,3.086];      
    case 'CO'
      res=[298,2500,110.598,-6.87,-0.4,0,12.6,142.69,6.088];
    case 'CO2'
      res=[298,2500,393.777,-19.55,16.7,-3.48,16.7,-138.33,10.421];
    case 'CeO2'
      res=[298,1048,1089.32,9.6,-15.9,0,8.0,244.9,0.029;1048,2500,0,-5.0,9.2,0,8.0,163.3,-7.201];      
    case 'Ce2O3'
      res=[298,1048,1821,7.5,-14.2,0,11.7,322.0,1.711;1048,1960,0,-21.8,36.0,0,11.7,158.7,-12.745;1960,2500,0,36.8,-1.7,0,11.7,545.1,28.491];
    case 'Co3O4'
      res=[298,723,854,-5.0,15.1,0,15.9,308.6,4.713;723,1398,0,13.0,-4.6,0,15.9,430.8,-2.575];
    case 'CoO'
      res=[298,723,239.5,3.8,-9.2,0,3.8,108.4,0.343;723,1398,0,10.0,-15.9,0,3.8,149.1,-2.269;1398,1766,0,-16.3,8.8,0,3.8,-33.9,10.237;1766,2078,0,-10.9,8.8,0,3.8,21,-14.863;2078,2500,0,13.0,-0.4,0,3.8,183.8,5.677];      
    case 'Cr2O3'
      res=[298,2173,1130.4,1.76,-12.18,0,-0.17,422.9,6.908;2173,2495,0,-11.22,7.5,0,-3.8,184.6,-9.353;2495,2500,0,25.92,7.5,0,-3.8,846.1,-712.97];      
    case 'CrO2'
      res=[298,1660,590,10.5,1.7,0,-2.9,252.5,-4.558];
    case 'CrO3'
      res=[298,460,579.5,1.3,5.4,0,5.4,266.3,0.473;460,1000,0,38.6,-11.3,0,13.8,467.2,12.464];            
    //F
  case 'FeO'
    res=[298,1033,266.7,20.43,-23.49,0,0.54,205.2,-4.798;1033,1180,0,-9.2,6.3,0,2.5,3.8,8.1978;1180,1641,0,14.24,-6.32,0,2.5,177.1,-11.38;1641,1673,0,23.0,-13.0,0,3.8,221.1,14.683;1673,1808,0,0.4,-0.4,0,3.8,50.2,34.688;1808,2500,0,1.7,-0.4,0,3.8,69.9,16.253];
  case 'Fe2O3'
    res=[298,950,822.7,18.17,16.7,0,-6.66,402.8,-9.035;950,1033,0,70.59,-61.1,0,8.4,739.0,-21.42;1033,1050,0,11.72,-1.7,0,11.7,335.8,4.58;1050,1180,0,-6.28,5.9,0,11.7,201.0,19.284;1180,1673,0,40.19,-19.2,0,11.7,548.1,-19.879;1673,1808,0,5.44,5.9,0,11.7,206.1,20.13];
  case 'Fe3O4'
    res=[298,900,1122,-19.97,110.45,0,10.5,238.6,3.668;900,1033,0,89.39,-91.3,0,10.5,910.2,-13.021;1033,1180,0,1.09,-2.1,0,15.9,306.1,25.979;1180,1673,0,70.8,-39.8,0,15.9,826.5,-32.766;1673,1808,0,2.34,-2.1,0,15.9,314.0,27.248;1808,1870,0,6.11,-2.1,0,15.9,373.0,-28.056];
    //G
  case 'GeO'
    res=[298,983,255,1.7,5.4,0,1.7,103.8,-0.486;983,1232,0,-7.5,-3.8,0,2.9,-190.1,221.65;1232,2500,0,-13.4,1.3,0,2.9,-203.9,190.5];
      //H
  case 'H2O'
      res=[298,373.16,286.03,30.48,-3.94,0,3.94,363.87,-7.796;373.16,2500,0,-14.99,6.78,0,5.0,-56.61,-19.996];
    //K    
  case 'K2O'
    res=[298,336.4,361.7,38.1,-136.1,0,3.8,346.2,-4.208;336.4,980,0,-25.1,64.5,-24.7,3.8,5.0,1.365;980,1052,0,0.4,37.7,-24.7,3.8,141.1,17.672;1052,1325,0,33.1,-0.4,0,3.8,525.4,-136.29;1325,2500,0,3.8,-0.4,0,3.8,200.1,-11.426];
  case 'K2O2'
    res=[298,336.4,494,41.4,-141.1,0,8.0,449.7,-3.848;336.4,763,0,-21.8,59.9,-24.7,8.0,98.4,1.725;763,1052,0,12.6,37.3,-24.7,8.0,304.8,11.417;1052,1800,0,45.2,-1.3,0,8.0,689.6,-169.57;1800,2500,0,7.5,-1.3,0,8.0,264.6,86.67];
    //M      
  case 'MgO'
    res=[298,923,602.2,5.86,-5.87,0,-4.379,148.2,-3.157;923,1393,0,-5.44,4.6,0,-4.6,80.0,-6.473;1393,2500,0,7.37,4.6,0,-4.6,279.3,-156.04];
  case 'MgO2'
    res=[298,500,623.0,-6.3,-1.3,0,8.4,105.1,4.296];
  case 'MoO2'
    res=[298,2200,548,10,5.9,0,-4.6,246.2,-5.334;2200,2500,0,38.5,-6.7,0,8.0,433.8,29.986];
  case 'MoO3'
    res=[298,1068,754.9,-18,49.4,0,11.7,748.6,6.481;1068,1530,0,44.0,-7.1,0,11.7,530.64,25.03;1530,2500,0,0.8,-7.1,0,11.7,81.2,229.18];
  case 'MnO'
    res=[298,1000,385.2,5.36,-6.57,0,1.8,107.35,-0.888;1000,1374,0,-5.69,4.81,0,0.4,33.91,2.035;1374,1410,0,-15.16,7.5,0,0.4,-41.83,10.777;1410,1517,0,-18.09,7.5,0,0.4,-61.57,12.519;1517,2058,0,-16.83,7.5,0,0.4,-41.57,-4.035;2058,2368,0,-6.87,-0.4,0,3.8,1.59,47.19;2368,2500,0,13.0,-0.4,0,3.8,270.59,-224.66];
  case 'Mn2O3'
    res=[298,1000,971.8,3.8,5.0,0,1.3,287.2,-1.553;1000,1374,0,-18.0,28.1,0,-1.7,140.3,4.291;1374,1410,0,-38.1,33.5,0,-1.7,11.7,21.776;1410,1517,0,-43.1,33.5,0,-1.7,-50.7,25.259;1517,1700,0,-40.6,33.5,0,-1.7,10.5,-7.859];
  case 'Mn3O4'
    res=[298,1000,1387.5,4.2,0.67,0,11.14,378.9,2.613;1000,1374,0,-28.85,34.83,0,6.7,158.3,11.38;1374,1410,0,-58.62,43.1,0,6.7,-69.9,37.606;1410,1445,0,-66.15,43.1,0,6.7,-128.1,42.83;1445,1517,0,-1.0,-2.1,0,15.9,330.8,17.442;1517,2058,0,2.76,-2.1,0,15.9,391.0,-32.234;2058,2368,0,-2.1,-2.1,0,15.9,273.4,115.3;2368,2500,0,57.4,-2.1,0,15.9,1080.2,-700.2];
    //N     
  case 'Na2O'
    res=[298,371,416.2,1.05,-5.15,-5.0,3.8,136.1,1.068;371,1178,0,-26.54,60.37,-21.4,3.8,-18,1.805;1187,1193,0,6.7,22.2,0,3.8,389.8,-218.63;1193,1600,0,33.1,-0.4,0,3.8,551.0,-204.27;1600,2500,0,3.8,-0.4,0,3.8,229.4,-35.956];
  case 'N2O'
    res=[298,2500,-81.6,0.08,5.53,0,-5.15,78.96,-2.026];
  case 'NO2'
    res=[298,2500,-33.47,0,0,0,0,240.161,0];
  case 'N2O3'
    res=[298,2500,-83.26,0,0,0,0,307.105,0];
    //P      
  case 'P2O5'
    res=[298,317.4,1507,-80.01,16.3,0,19.7,-36.8,22.148;317.4,553,0,-91.77,222.3,0,26.0,-96.7,23.605;553,631,0,-212.7,224.4,-2.5,19.7,-54.0,-2.261;631,2500,0,26.8,-1.7,-2.5,19.7,631.4,4.497]; 
  case 'P2O3'
    res=[298,317.4,1097,64.1,-61.5,0,11.7,658.0,-13.013;317.4,448.5,0,52.3,-2.5,0,18.0,598.3,-11.551;448.5,553,0,-29.3,39.4,0,18.0,5.0,39.695;553,2500,0,-30.1,41.0,-2.5,11.7,37.3,13.829];
  case 'PtO'
    res=[298,780,71,-3.8,20.5,0,3.4,67.8,1.143];
  case 'Pt3O4'
    res=[298,2000,268,-12.6,54.0,0,14.7,289.7,5.369];
  case 'PtO2'
    res=[298,723,134,-12.1,33.5,0,7.5,102.2,4.22;723,750,0,29.3,-6.7,0,7.5,360.9,4.015];
  case 'PbO'
    res=[298,600.6,219.4,3.43,6.57,0,3.8,122.7,-0.209;600.6,762,0,-5.36,19.26,0,3.8,72.9,-2.395;762,1159,0,-11.89,29.31,0,3.8,28.5,1.725;1159,1745,0,11.3,2.5,0,3.8,174.6,4.513;1745,2023,0,-15.9,4.2,0,3.8,173.8,262.97;2023,2500,0,-4.2,1.3,0,3.8,8.4,67.78];
  case 'Pb3O4'
    res=[298,600.6,735.2,-10.0,42.7,0,15.9,331.6,5.489;600.6,1200,0,-37.3,80.8,0,15.9,181.3,0.188];
      //S
    case 'SiO'
      res=[298,1683,437.9,-10.5,5.4,0,8.4,20.1,5.531;1683,2250,0,-17.6,9.6,0,3.8,-5,-35.274];
    case 'SiO2'
      res=[298,848,880.1,-11.51,28.97,0,1,112.83,2.06;848,1683,0,1.84,2.76,0,12.1,190.83,2.114;1683,1883,0,-5.4,7.1,0,8.0,167.5,-38.69;1883,2500,0,18.0,-1.3,0,8.0,347.5,-59.83];
    case 'Sb2O3'
      res=[298,903.7,699.6,-18.09,55.3,0,11.7,161.2,6.263;903.7,928,0,-34.75,69.9,0,11.7,88.3,-24.824;928,1698,0,36.0,-1.7,0,11.7,509.5,2.056;1698,1713,0,-27.6,-1.7,0,11.7,-49.4,147.46;1713,2500,0,-2.1,-1.7,0,12.6,393.1,-287.01];
    case 'Sb2O5'
      res=[298,903.7,963,-38.9,81.6,0,19.7,228.6,13.523;903.7,1200,0,-55.37,96.3,0,19.7,155.7,-17.559];
    case 'SeO2'
      res=[298,490.6,230.3,5.0,-12.6,0,7.1,211.9,0.971;490.6,603,0,-10.5,24.3,0,7.1,128.9,-1.096;603,1000,0,-3.3,-1.3,0,8.0,-4.2,101.91;1000,2500,0,7.5,-1.3,0,8.8,139.4,31.652];
    case 'SO2'
      res=[298,368.6,297.1,-1.7,-21.27,0,-0.8,-30.23,0.854;368.6,392,0,-1.7,-24.24,0,-0.8,-29.73,0.657;392,717.76,0,-9.6,-15.9,0,-0.8,-77.12,1.821;717.76,2500,0,-4.6,4.2,0,3.3,8.21,-10.76];
    case 'SO3'
      res=[298,2500,395.84,0,0,0,0,256.68,0];
      //T
    case 'TiO2'
      res=[298,1155,944.1,18.63,-10.47,0,-10.5,311.04,-8.981;1155,2000,0,9.21,0,0,-10.5,252.92,-9.115;2000,2128,0,8,0,0,-10.5,251.71,25.862;2128,2500,0,22.2,-1.3,0,8,342.1,13.657];
    case 'TiO'
      res=[298,1155,518.7,4.94,3.98,0,-3.8,135.07,-3.157;1155,1264,0,-4.44,14.7,0,-3.8,74.86,-3.291;1264,2000,0,0.92,12.1,0,3.8,112.37,-4.019;2000,2010,0,-0.4,12.1,0,3.8,111.16,-20.808];      
    case 'Ti2O'
      res=[298,508.3,177.9,4.6,-4.2,0,2.5,161.2,-0.544;508.3,573,0,-12.1,24.7,0,2.5,53.6,3.709;573,576.8,0,14.2,-0.4,0,3.8,196.4,13.867;576.8,773,0,12.6,-0.4,0,3.8,198.9,6.205;773,1730,0,-22.6,-0.4,0,3.8,-162.9,105;1730,2500,0,-1.7,-0.4,0,3.8,204.3,-256.7];
    case 'Ti2O3'
      res=[298,473,1519.4,-65.31,201.34,0,11.7,-93.57,13.842;473,1155,0,49.32,-17.29,0,-31.0,631.03,-24.451;1155,2000,0,30.48,3.8,0,-31.0,510.62,-24.3;2000,2400,0,28.15,3.8,0,-31.0,507.78,-57.778;2400,2500,0,39.8,-1.7,0,11.7,556.4,31.803];
    case 'ThO'
      res=[298,2150,607,-5.4,12.6,-8.4,3.8,53.6,2.968;2150,2173,0,11.3,2.5,-8.4,3.8,152,44.63;2173,2500,0,12.1,-0.4,0,3.8,181.3,1.938];
    case 'ThO2'
      res=[298,2173,1227.61,0,11.97,-8.4,-0.4,197.37,-0.515;2173,2500,0,0.8,8.8,0,-0.4,226.5,-43.21];
    case 'Ta2O5'
      res=[298,2150,2046.5,-13.0,32.7,0,19.7,365.1,7.984;2150,2500,0,57.4,-9.2,0,19.7,853.7,20.515];
    case 'TeO'
      res=[298,621,234,-0.4,3.3,0,3.8,93.4,1.101;621,723,0,-0.4,3.3,0,3.8,94.2,0.557;723,1020,0,-18.8,25.6,0,3.8,-5.4,-9.73;1020,1360,0,10.0,-0.4,0,3.8,167.9,4.036;1360,1775,0,28.9,-0.4,0,4.2,360.1,-71.59;1775,2500,0,1.3,-0.4,0,4.2,8.0,186.82];
    case 'TeO2'
      res=[298,621,325.27,4.2,5.9,0,8.0,208.9,0.716;621,723,0,4.2,5.9,0,8.0,210.2,0.172;723,1006,0,-14.2,27.6,0,8.0,110.1,-10.115;1006,1360,0,11.3,-1.3,0,8.0,271.7,-8.043;1360,2500,0,30.6,-1.3,0,8.4,464.3,-83.65];
      //V
    case 'VO'
      res=[298,2003,418.7,6.78,2.14,0,-1.3,139.8,-2.767;2003,2350,0,-5.9,6.3,0,-1.3,47.3,-2.25;2350,2500,0,7.5,-0.4,0,3.8,121.4,48.11];
    case 'V2O3'
      res=[298,2003,1239.7,24.28,10.17,0,-10.9,440.07,-11.983;2003,2240,0,-1.3,18.4,0,-10.9,255.0,-10.953;2240,2350,0,35.2,-1.7,0,11.7,480.6,59.41];
    case 'V3O5'
      res=[298,2003,2114,-5.9,110.6,0,19.7,450.9,2.353;2003,2100,0,-44.0,123.1,0,19.7,172.9,3.894;2100,2500,0,38.1,-2.5,0,19.7,535.5,283.53];
    case 'VO2'
      res=[298,345,715.9,4.69,-5.0,0,8.0,208.59,1.051;345,1818,0,16.79,1.97,0,-8.62,288.39,-4.057;1818,2003,0,48.82,-5.0,0,8.0,516.27,7.323;2003,2500,0,36.0,-1.3,0,8.0,423.3,7.838];
    //W
  case 'WO2'
    res=[298,1543,570.7,15.1,13.4,0,-8.8,285.5,-8.457;1543,2125,0,41.9,-4.2,0,8.0,450.5,20.365];  
  case 'WO3'
    res=[298,1743,840.88,-3.4,27.6,0,11.7,237.0,3.115;1743,2100,0,49.8,-4.6,0,11.7,588.7,31.053;2100,2500,0,-0.4,-4.6,0,11.7,68.3,316.61];
    //Z
  case 'ZnO'
    res=[298,692.7,348.8,9.29,-5.48,0,-5.0,164.25,-4.48;692.7,1180,0,0.33,4.6,0,-5.0,112.96,-7.344;1180,2248,0,10.93,4.6,0,-5.0,86.54,-134.73;2248,2500,0,21.4,-0.4,0,3.8,354.6,-98.81];
  end;
    //

endfunction
//
//function [DZ]=DZbyF(Subst,T_int)
//    select  Subst
//        case 'SO3'
//endfunction

//
function [rn,rc,T1,T2,DH298,Da,Db,Dc,Dd,I1,I2]=DatSubst(Subst,rec)
  //Функция выдает данные о веществе (Subst) в заданном температурном интервале (rec)
  //rn -номер температурного интервала (по умолчанию rn=1)
  //rc -количество температурных интервалов (1)
  //T1,T2 -границы заданного температурного интервала
  //DH298,Da,Db,Dc,Dd,I1,I2 коэффициенты уравнения для данного интервала
  //Получение матрицы с данными
  res1=Dat(Subst);
  //Размерность матрицы
  [nr,nc]=size(res1);
  //Выбор строки
  if(nr>=rec) then 
      res=res1(rec,:)
    else 
      res=res1(nr,:)
  end;
  //Результаты
  rc=nr;
  rn=rec;
  T1=res(1);
  T2=res(2);
  DH298=res(3);
  Da=res(4);
  Db=res(5);
  Dc=res(6)
  Dd=res(7);
  I1=res(8);
  I2=res(9);
  //Обработка данных
  DH298=-DH298*1000;
  Db=Db*0.001;
  Dc=Dc*0.000001;
  Dd=Dd*100000;
  I2=-I2*1000;
endfunction
//
function [z_o]=cor_O(Subst)
  //  Множители для пересчета на 1 моль O2
  //  для оксидов
  //  Subst - формула вещества  (строка)
  l=length(Subst);
  sumb1=part(Subst,l);
  if(sumb1=='O') then z_o=0.5;
    else z_o=strtod(sumb1)/2;
  end;
  //
endfunction;
//
//
function [T,DZ,int_count]=DZ_int(Subst,T_int)
  //Изобарно-изотермический потенциал вещества (Subst) для температурного интервала T_int
  //T -Массив значений температуры (по умолчанию шаг равен 10)
  //DZ -Массив значений изобарно-изотермического потенциала
  //int_count -Общее количество температурных интервалов
  //
  [rn,rc,T1,T2,DH298,Da,Db,Dc,Dd,I1,I2]=DatSubst(Subst,T_int);
  int_count=rc;
  T=T1:10:T2;
  DZ=DH298-Da.*T.*log(T)-(1/2).*Db.*T.^2-(1/6).*Dc.*T.^3-(1/2).*Dd.*T.^(-1)+I1.*T-I2;
  //
  [z_o]=cor_O(Subst);
  
  DZ=DZ./z_o;
  DZ=DZ./1000; 
endfunction
//
//
function plotSubstInt(Subst,T_int)
  //Построение графика изобарно-изотермического потенциала для вещества (Subst) в температурном интервале T_int
  //Расчет
  [T,DZ,int_count]=DZ_int(Subst,T_int);
  //Вывод графика
  plot2d(T,DZ);
  //Оформление
  titleX='T, K';
  titleY='DZ, кДж/моль';
  name='Диаграммa '+Subst;
  xtitle(name,titleX,titleY);
  xgrid(000); 
endfunction
//
function plotSubst(Subst)
  //Построение графика изобарно-изотермического потенциала для вещества (Subst) во всех температурных интервалах
  //
  i=1;
  int_count=1;
  T1=[];
  DZ1=[];
  DZD1=[];
  DZD2=[];
  DZD=0;
  DZD=[];
  //Перебор интервалов
  while(i<=int_count)
    //Расчет
    [T,DZ,int_count]=DZ_int(Subst,i);
    //Сопряжение графиков разных температурных интервалов
    DZ_count=size(DZ,'*');
    DZD1(i)=DZ(1);
    DZD2(i)=DZ(DZ_count);
    if(i>1) then
      DZD=DZD+DZD1(i)-DZD2(i-1);
      DZ=DZ-DZD;
    end;
    //Запись результатов в объединенные массивы
    T1=[T1,T];
    DZ1=[DZ1,DZ];
    i=i+1;
  end;
  //Вывод графика
  plot2d(T1,DZ1);
  //Оформление
  titleX='T, K';
  titleY='DZ, кДж/моль';
  name='Диаграммa '+Subst;
  xtitle(name,titleX,titleY);
  xgrid(000); 
endfunction
//
function plotPolySubst(Subst)
  //Построение графиков изобарно-изотермического потенциала для веществ 
  //(Subst -массив наименований веществ) 
  //во всех температурных интервалах
  //в одних координатах
  //
  //Перебор массива Subst
  countSubst=size(Subst,"*");
  j=1;
  name='Диаграммы ';
  name1='_';
  //
  while(j<=countSubst)
    //Расчет одного графика
    i=1;
    int_count=1;
    T1=[];
    DZ1=[];
    DZD1=[];
    DZD2=[];
    DZD=0;
    DZD=[];
    //Цвет кривой
    c1=j;
    //
    //Перебор температурных интервалов
    while(i<=int_count)
      //Расчет
      [T,DZ,int_count]=DZ_int(Subst(j),i);
      //Сопряжение графиков разных температурных интервалов
      DZ_count=size(DZ,'*');
      DZD1(i)=DZ(1);
      DZD2(i)=DZ(DZ_count);
      if(i>1) then
        DZD=DZD+DZD1(i)-DZD2(i-1);
        DZ=DZ-DZD;
      end;
      //Запись результатов в объединенные массивы
      T1=[T1,T];
      DZ1=[DZ1,DZ];
      //
      i=i+1;
    end;
    //Вывод графиков
    //
    plot2d(T1,DZ1);
    //Параметры вывода
    mtlb_hold('on');
    name=name+Subst(j)+'; ';
    name1=name1+Subst(j)+'_';
    //
    j=j+1;
  end;
  //Изменение стилей графиков
  j=1;
  a=gca();//Получить текущие оси
  while(j<=countSubst)
    ch1=a.children(j);//Кривые по порядку
    cf=ch1.children;//Свойства кривых
    cf.line_style=j;//Изменение стиля линии
    j=j+1;
  end
  //Оформление
  titleX='T, K';
  titleY='$\Delta Z, кДж/моль$';
  legend(Subst,4);
  xtitle(name,titleX,titleY);
  xgrid(000);
  //экспорт в графический файл
  x=getdate();
  fname="ris"+name1+string(x(9))+string(x(10))+".jpg";
  xs2jpg(0,fname);
endfunction
//
//Точки фазовых переходов
function phaseT(Subst)
 //(Subst -массив наименований веществ) 
 //во всех температурных интервалах
 //в одних координатах
 //
 //Расчет
 j=1;
 r=size(Subst,"*")
 while(j<=r)
      disp(Subst(j));
      res=Dat(Subst(j));
      T12=res(:,2);
      disp(T12);
      j=j+1;
 end;     
endfunction
//Вывод графиков с точками фазовых переходов
function graph()
group1a=['K2O','K2O2','Na2O'];
group1b=['Ag2O','CuO','Cu2O'];
group2a3=['CaO','MgO','CaO2','BeO'];
group3a=['B2O3','Al2O3'];
group4a1=['Pb3O4','PbO','GeO'];
group4a2=['SiO','SiO2','FeO'];
group4b=['TiO2','TiO','Ti2O3','Ti2O'];
group5a3=['Sb2O5','Sb2O3','Bi2O3','BiO'];
group5b=['Ta2O5','VO','V2O3','V3O5'];
group6b1=['Cr2O3','CrO2','CrO3'];
group6b2=['MoO3','MoO2','WO2','WO3'];
group7=['MnO','Mn3O4','Mn2O3'];
group8b1=['PtO','Co3O4','Fe2O3','FeO'];
group6a2=['SO3','NO2','N2O3','FeO'];
gr=[group1a,group1b,group2a3,group3a,group4a1,group4a2,group4b,group5a3,group5b,group6b1,group6b2,group7,group8b1];
//
      plotPolySubst(group1a);
      clf();
      plotPolySubst(group1b);
      clf();
endfunction;
